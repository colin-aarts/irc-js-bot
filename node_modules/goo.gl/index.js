// Generated by IcedCoffeeScript 1.3.3b
(function() {
  'use strict';

  var https;

  https = require('https');

  module.exports = function(uri, cb) {
    var req, result;
    result = [];
    req = https.request({
      hostname: 'www.googleapis.com',
      path: '/urlshortener/v1/url',
      method: 'post',
      headers: {
        'Content-Type': 'application/json'
      }
    }, function(res) {
      res.setEncoding('utf-8');
      res.on('data', function(data) {
        return result.push(data);
      });
      return res.on('end', function() {
        var err;
        result = result.join('');
        result = JSON.parse(result);
        if (!result || !result.id) {
          err = true;
        } else {
          result = result.id;
        }
        return cb(err, result);
      });
    });
    req.on('error', function(err) {
      return cb(err, null);
    });
    return req.end("{ \"longUrl\": \"" + uri + "\" }");
  };

}).call(this);
